# AI4ArtsEd Web Server Requirements
# Python 3.11+ required
#
# Installation:
#   python3 -m venv venv
#   source venv/bin/activate
#   pip install -r requirements.txt
#
# System dependencies (Ubuntu/Debian):
#   sudo apt install libcairo2-dev libpango1.0-dev libjpeg-dev libgif-dev libgirepository1.0-dev

# ============================================================================
# Web Framework
# ============================================================================
Flask==3.0.0         # Web application framework
Flask-CORS==4.0.0    # Cross-Origin Resource Sharing support
flask-compress==1.17 # gzip/brotli response compression

# ============================================================================
# HTTP Server (Production)
# ============================================================================
waitress==2.1.2      # Production WSGI server (alternative to gunicorn)

# ============================================================================
# HTTP Clients
# ============================================================================
requests==2.31.0     # Synchronous HTTP client (for OpenRouter, Ollama)
aiohttp==3.13.2      # Async HTTP client (required by comfyui_client.py and swarmui_client.py)

# ============================================================================
# Configuration & Environment
# ============================================================================
python-dotenv==1.0.0 # Load environment variables from .env file
toml>=0.10.2         # Kohya dataset config files (training_service)

# ============================================================================
# Export Functionality
# ============================================================================
weasyprint==60.2     # PDF generation (requires cairo, pango system libs)
python-docx==1.1.0   # DOCX (Word document) generation
lxml>=5.1.0          # XML processing and parsing

# ============================================================================
# PyTorch (GPU Backend)
# ============================================================================
# IMPORTANT: PyTorch must be installed BEFORE this file, with correct CUDA version:
#   # For Blackwell GPUs (sm_120) - CUDA 13.0 nightly required:
#   pip install --pre torch torchaudio torchvision --index-url https://download.pytorch.org/whl/nightly/cu130
#   # For older GPUs (Ampere/Ada) - CUDA 12.1:
#   pip install torch torchaudio torchvision --index-url https://download.pytorch.org/whl/cu121
#
# These are NOT listed below because they require a special --index-url.

# ============================================================================
# Diffusers Backend (Image Generation)
# ============================================================================
diffusers>=0.32.0    # HuggingFace Diffusers (SD3.5, Flux2, Stable Audio)
peft>=0.12.0         # Parameter-Efficient Fine-Tuning (LoRA support for Diffusers)
scipy>=1.12.0        # WAV audio file I/O (Stable Audio backend)
transformers>=4.45.0 # HuggingFace Transformers (text encoders)
accelerate>=0.34.0   # HuggingFace Accelerate (device management)
safetensors>=0.4.0   # Safe model loading format
sentencepiece>=0.2.0 # T5 tokenizer dependency

# ============================================================================
# HeartMuLa Backend (Music Generation)
# ============================================================================
# heartlib is installed separately in editable mode:
#   pip install --no-deps -e /path/to/heartlib
#
# These are heartlib's runtime dependencies (installed here to avoid
# heartlib's pinned versions conflicting with our torch nightly):
vector-quantize-pytorch>=1.27.0  # HeartCodec audio codec
soundfile                        # Audio file I/O
bitsandbytes>=0.49.0             # Quantization support
einops>=0.8.0                    # Tensor operations
modelscope>=1.33.0               # Model hub
torchtune>=0.4.0                 # Fine-tuning utilities
torchao>=0.9.0                   # Torch AO (quantization)

# ============================================================================
# NLP / Safety (DSGVO NER Check)
# ============================================================================
spacy>=3.8.0             # NLP framework for named entity recognition (DSGVO check)
# Required NER models (installed separately, NOT via pip):
#   python -m spacy download de_core_news_lg    # German text (platform language)
#   python -m spacy download xx_ent_wiki_sm     # Multilingual (names from any language in German text)
# These 2 models cover the use case. Adding more (e.g. en_core_web_lg) causes
# cross-language false positives â€” en model flags "Der Eiffelturm" as PERSON.

# ============================================================================
# Optional: Development/Testing
# ============================================================================
# Uncomment for development:
# flask-debugtoolbar==0.13.1  # Debug toolbar for Flask
# pytest==7.4.3               # Testing framework
# pytest-flask==1.3.0         # Flask testing utilities
